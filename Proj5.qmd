---
title: "Racial Disparities in Police Search Practices Across Three California Cities"
subtitle: "A comparative analysis of racial disparities in police search practices across three major California cities."
description: |
  In this project, I will use traffic stop data collected from California Police agencies. The cities I look to examine are San Francisco, San Diego, and San Jose. The goal is to examine racial inequities and disparities in search behavior and contraband "hit" rates. I initially planned to compare Los Angeles as well; however, LA was underreported and did not contain key information like the driver's race. Through the use of SQL, I compare stop rates, specifically how different races are searched after a stop, and how frequently those searches actually find contraband. Next, I contrast patterns across cities to see whether some agencies search more aggressively but with lower success rates. The ultimate goal is to understand if search practices are applied evenly across racial groups and jurisdictions.

format:
  html:
    css: style.css
    code-fold: true

about:
  template: jolla
  image: images/police.jpeg
  image-shape: rounded
  image-width: 20em

execute:
  warning: false
  message: false
---

[View Original Data Set Here](https://openpolicing.stanford.edu/data/)

Reference:
  [A large-scale analysis of racial disparities in police stops across the United States, Nature Human Behaviour](https://doi.org/10.1038/s41562-020-0858-1)

Original Author:
  Pierson, E., Simoiu, C., Overgoor, J., Corbett-Davies, S., Ramachandran, V., Phillips, C., Shroff, R., & Goel, S. (2020).
  
```{r}
library(DBI)
library(RMariaDB)

con_traffic <- dbConnect(
  RMariaDB::MariaDB(),
  dbname = "traffic",
  host = Sys.getenv("TRAFFIC_HOST"),
  user = Sys.getenv("TRAFFIC_USER"),
  password = Sys.getenv("TRAFFIC_PWD")
)

```


Viewing SF lables 

```{sql connection=con_traffic}
SHOW COLUMNS FROM ca_san_francisco_2020_04_01;

```
Viewing LA labels 
```{sql connection=con_traffic}
SHOW COLUMNS FROM ca_los_angeles_2020_04_01;
```

Viewing San Diego Lables 


```{sql connection=con_traffic}
SHOW COLUMNS FROM ca_san_diego_2020_04_01;


```
Viewing San Jose 
```{sql connection=con_traffic}
DESCRIBE ca_san_jose_2020_04_01;

```

Viewing SF, SD, and SJ search & hit rates by race
```{sql connection=con_traffic, output.var="rates"}
SELECT 
    'San Francisco' AS city,
    subject_race,
    COUNT(*) AS n_stops,
    AVG(search_conducted = 1) AS search_rate,
    AVG(CASE WHEN search_conducted = 1 THEN contraband_found = 1 END) AS hit_rate
FROM ca_san_francisco_2020_04_01
WHERE subject_race IS NOT NULL
GROUP BY subject_race

UNION ALL

SELECT 
    'San Diego' AS city,
    subject_race,
    COUNT(*) AS n_stops,
    AVG(search_conducted = 1) AS search_rate,
    AVG(CASE WHEN search_conducted = 1 THEN contraband_found = 1 END) AS hit_rate
FROM ca_san_diego_2020_04_01
WHERE subject_race IS NOT NULL
GROUP BY subject_race

UNION ALL

SELECT 
    'San Jose' AS city,
    subject_race,
    COUNT(*) AS n_stops,
    AVG(search_conducted = 1) AS search_rate,
    AVG(CASE WHEN search_conducted = 1 THEN contraband_found = 1 END) AS hit_rate
FROM ca_san_jose_2020_04_01
WHERE subject_race IS NOT NULL
GROUP BY subject_race

ORDER BY city, subject_race;

```

```{r}
rates
```


Cleaning the data in order to visualize 

```{r}
library(tidyverse)

rates_clean <- rates |>
  mutate(
    search_rate = round(search_rate * 100, 1),
    hit_rate    = round(hit_rate * 100, 1)
  )

```

Visualization 1: Search Rates by Race

```{r}
ggplot(rates_clean, aes(x = subject_race, y = search_rate, fill = city)) +
  geom_col(position = "dodge") +
  labs(
    title = "Search Rates by Race Across Three California Cities",
    x = "Race",
    y = "Search Rate (%)",
    fill = "City"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
The figure above compares the likelihood that officers searched drivers from different racial groups across the three cities. What is clear is that the search rate varies significantly by race. In all three cities, Latino and Black drivers were searched at significantly higher rates than White and Asian drivers. These results help suggest that the decision to stop and search drivers is not uniformly applied across racial groups. Furthermore, the data seems skewed because San Jose has higher hit rates across all racial groups. This does not mean that individuals in San Jose are more likely to merit searches; instead, it reflects systematic differences in policing practices and reporting standards. San Jose likely documents searches more frequently and consistently or, more plausibly, operates under a system that has policies to increase the number of searches per stop. 


Visualization 2: Hit rates of contraband found by race 
```{r}
ggplot(rates_clean, aes(x = subject_race, y = hit_rate, fill = city)) +
  geom_col(position = "dodge") +
  labs(
    title = "Contraband Hit Rates by Race Across Three California Cities",
    x = "Race",
    y = "Hit Rate (%)",
    fill = "City"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
The contribution hit rate seen above shows significant differences in search effectiveness across the three cities. San Francisco consistently has the highest hit rates across racial groups, which suggests that its officers conduct fewer but far more targeted searches. San Jose conducts far more searches but has only mid-level hit rates, indicating a lower threshold for initiating searches that frequently do not result in contraband. San Diego has the lowest hit rates overall, which implies that many searches in the city are not based on strong suspicion. As a takeaway, it seems that San Francisco's searches are far more effective, San Jose's are more frequent but less productive, and San Diego's are both infrequent and largely unsuccessful. Overall, this plot highlights how policing strategies are highly varied and city-dependent, even when they all operate in the same state. 


Visualization 3
```{r}
library(ggplot2)
library(dplyr)

rates_eff <- rates |>
  mutate(
    search_rate_pct = search_rate * 100,
    hit_rate_pct = hit_rate * 100
  )

ggplot(rates_eff, aes(x = search_rate_pct, 
                      y = hit_rate_pct, 
                      color = city, 
                      size = n_stops, 
                      label = subject_race)) +
  geom_point(alpha = 0.8) +
  geom_text(vjust = -0.8, size = 3, show.legend = FALSE) +
  labs(
    title = "Search Efficiency: Search Rates vs Hit Rates Across Racial Groups",
    subtitle = "Each point sized by number of stops; labels represent racial groups",
    x = "Search Rate (%)",
    y = "Hit Rate (%)",
    color = "City",
    size = "Number of Stops"
  ) +
  theme_minimal() +
  theme(plot.title = element_text(size = 14, face = "bold"))

```



For this visualization, I was interested in exploring whether some groups are searched more but found with contraband less often. On the contrary, there are some groups that are searched less but found with contraband more. The goal was to help unpack biases that officers may have. The plot compares how different racial groups are searched and how often those searches actually find contributors. San Diego shows both low search rates and low hit rates across all racial groups, which suggests fewer searches overall but simultaneously less efficiency. San Francisco, by contrast, shows moderate search rates paired with higher hit rates, which indicates more targeted, successful searches. San Jose consistently has the highest search rates but only mid-level hit rates. This implies that officers search more often but are way less efficient. 


Conclusion- 

Across San Francisco, San Diego and San Jose, the data above highlights clear racial disparities when it comes to the frequency of drivers being searched and how effective those searches are. Cities have stark differences in regards to search intensity as well as efficiency. San Francisco for example, conducts fewer yet more targeted searches. Where San Jose searches far more often but with lower sucess rates. 

Togather, these results help suggest that policing stratagies and potential biases vary substantially across police jurisdictions. This helps underscore the need for consistant statewide oversight that involves data driven policy reform. 



Sources Cited: 

Pierson, Emma, et al. “A Large-Scale Analysis of Racial Disparities in Police Stops Across the United States.” Nature Human Behaviour, 2020.
Data from: Stanford Open Policing Project (https://openpolicing.stanford.edu
).

[image source: OpenPolicing](https://openpolicing.stanford.edu/news/)